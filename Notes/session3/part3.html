<!DOCTYPE html>
<html lang="en-UK">
<!--xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">-->

<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
    <meta content="Session 3: Layered material simulations" name="description"/>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,400;0,600;1,400&display=swap"
          rel="stylesheet">
    <link href="../scripts/style.css" rel="stylesheet"/>
    <title>Part 3 &ndash; Analysis of the Simulation Data</title>
</head>

<body>

<div class="box">
    <h1 id="title">Part 3 &ndash; Analysis of the Simulation Data</h1>
    <p> &uarr; <a href="Session3.html">Go to the main menu</a> <br>
        &larr; <a href="part2.html">Go to the previous part &ndash; Running a Molecular Dynamics Simulation</a> </p>
</div>

<div class="box">
    <h2 id="overview">Contents</h2>
</div>

<div class="box">
    <h2 class="enum" id="toc_1">Analysis of the equilibration</h2>
    <p>
        As in the previous session, you should check that your system has equilibrated by looking at the temperature and pressure evolution.
    </p>
    <div class="bbox">
        <h3 id="Calculate_the_temperature_evolution"></h3>
        <ol>
            <li>
                Visualise the temperature evolution
            </li>
            <li>
                Start an interactive session on Eddie:
                <p>
                    Use the instructions from <a href="../session2/part3.html#interactive_login">Session 2</a> to
                    start an interactive session on Eddie and load the GROMACS module.
                </p>
            </li>
            <li>Refer to the <a href="../session2/part3.html#Calculate_the_temperature_evolution">Session 2</a> for instructions on
                how to calculate the temperature evolution of the system.
            </li>
            <li>Visualise the result in xmgrace. Has the temperature of your system equilibrated?
            </li>
            <li>Save the xmgrace plot as a <code>.png</code> file:
                <ol>
                    <li>In the xmgrace window open the <code>File</code> menu and select <code>Print setup</code></li>
                    <li>In the <code>Device setup</code> field <code>PNG</code></li>
                    <li>Set the file path in the <code>Output</code> field and include the <code>.png</code>
                        suffix.
                    </li>
                    <li>Click <code>Apply</code> and <code>Accept</code></li>
                    <li>In the <code>File</code> menu, click <code>Print</code>.</li>
                </ol>
            </li>
        </ol>
        <div class="flex-figure" style="margin-top:-8mm;">
            <div class="figure" style="width: 70%">
                <figure>
                    <img src="img/eq_temp.png" width="100%">
                    <figcaption>
                        Example Xmgrace plot of the temperature evolution during equilibration.
                    </figcaption>
                </figure>
            </div>
        </div>
    </div>

    <div class="bbox">
        <h3 id="Calculate_the_pressure_evolution"></h3>
        <ol>
            <li>
                Visualise the pressure evolution
            </li>
            <li>
                Start an interactive session on Eddie:
                <p>
                    Use the instructions from <a href="../session2/part3.html#interactive_login">Session 2</a> to
                    start an interactive session on Eddie and load the GROMACS module.
                </p>
            </li>
            <li>Refer to the <a href="../session2/part3.html#Calculate_the_pressure_evolution">Session 2</a> for instructions on
                how to calculate the pressure of the system.
                <blockquote style="margin-top:1mm">
                    <p>Remember to use the relevant parameters from the <code>.mdp</code> file to calculate the length of average required to
                        create a 2-ps running average.</p>
                </blockquote>
            </li>
            <li>Visualise the result in xmgrace. Has the pressure of your system equilibrated?
            </li>
            <li>Save the xmgrace plot as a <code>.png</code> file.
            </li>
        </ol>
         <div class="flex-figure" style="margin-top:-8mm;">
            <div class="figure" style="width: 70%">
                <figure>
                    <img src="img/eq_pres.png" width="100%">
                    <figcaption>
                        Example Xmgrace plot of the pressure evolution during equilibration.
                    </figcaption>
                </figure>
            </div>
        </div>
    </div>
</div>

<div class="box">
    <h2 class='enum' id="toc_2">Analysis of the simulation data</h2>
    <p>In this section, you will:</p>
    <ul>
        <li>Calculate the root-mean-square deviation (<abbr>RMSD</abbr>) of the system to determine from which
            point on the system is equilibrated
        </li>
        <li>Determine the radial distribution function (RDF) of the ions to analyse their hydration shell</li>
        <li>Perform a linear density analysis of the ions on the axis perpendicular to the clay surface to characterise
            the interactions between ions and the clay surface
        </li>
    </ul>
    <h3 class="enum" id="toc_2_1">Calculating the root-mean-square deviation (<abbr>RMSD</abbr>)</h3>
    <p>
        In mineral systems, the RMSD is an important measure to determine when a simulation has reached equilibrium. When the RMSD has reached a
        plateau, the system has reached equilibrium.
    </p>
    <p>
        It is only after the system has reached equilibrium that you are producing meaningful data that can be representative of the simulated system.
    </p>
    <div class="bbox">
        <h3 id="Calculating_the_RMSD"></h3>
        <ol>
            <li>
                Calculate the <abbr>RMSD</abbr> of the system
            </li>
            <li>
                Start an interactive session on Eddie:
                <p>
                    Use the instructions from <a href="../session2/part3.html#interactive_login">Session 2</a> to
                    start an interactive session on Eddie and load the GROMACS module.
                </p>
            </li>
            <li>Refer to the <a href="../session2/part3.html#Calculating_the_RMSD">Session 2</a> for instructions on
                how to calculate the <abbr>RMSD</abbr> of the system.
            </li>
            <li>Visualise the result in xmgrace and determine the time point at which the system is equilibrated. You will <strong>begin the
                subsequent analyses starting from this time point</strong>.
            </li>
            <li>Save the xmgrace plot as a <code>.png</code> file.
            </li>
        </ol>
        <div class="flex-figure" style="margin-top:-8mm;">
            <div class="figure" style="width: 70%">
                <figure>
                    <img src="img/rmsd.png" width="100%">
                    <figcaption>
                        Example Xmgrace plot of the RMSD evolution for the entire system during a production run.
                    </figcaption>
                </figure>
            </div>
        </div>
    </div>

    <h3 class="enum" id="toc_2_2">Calculating the radial distribution function (<abbr>RDF</abbr>)</h3>
    <p>
        The radial distribution function (<abbr>RDF</abbr>) is a measure of the probability of finding a particle at a
        certain distance from another particle. We are going to use it to analyse the hydration shell of Na<sup>+</sup>
        ions.
    </p>
    <div class="bbox">
        <h3 id="Calculating_the_RDF"></h3>
        <ol>
            <li>
                Calculate the radial distribution function of the ions
            </li>
            <li>
                Use <a href="https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-make_ndx.html"
                               target="_blank"><code>make_ndx</code></a> to create an index file for water OW atoms:
                <p>GROMACS does not have water <code>OW</code> atoms in its default selections.
                    Therefore, we have to first create a new index <code>.ndx</code> file that also contains this atom
                    group.</p>
                <pre style="margin-top:1mm">$ gmx make_ndx -f prod.gro -o OW.ndx</pre>
                <blockquote style="margin-top:1mm">
                    <p>Select OW atoms by adding the new group to the index file:<br>
                        Type each line and press <code>Enter</code>.</p>
                    <pre>&gt; a OW</pre>
                    <p>Exit and save the index file by typing <code>q</code> and pressing <code>Enter</code>.
                    </p>
                </blockquote>
            </li>
            <li>
                Use the <a href="https://manual.gromacs.org/documentation/2019/onlinehelp/gmx-rdf.html" rel="noopener"
                           target="_blank"><code>gmx rdf</code></a> tool to calculate the <abbr>RDF</abbr>:
                <blockquote>
                <pre>
$ gmx rdf -f prod.xtc -s prod.tpr -n Na_OW.ndx -o rdf_Na_OW.xvg -seltype atom -selrpos atom -b &lt;analysis_start_time&gt; -tu &lt;time_unit&gt; -norm number_density -rmax 1</pre>
                    <p><code>-f</code> specifies the trajectory file.</p>
                    <p><code>-s</code> specifies the input topology <code>.tpr</code> file.</p>
                    <p><code>-o</code> specifies the ouput file.</p>
                    <p><code>-seltype</code> specifies the selection type.</p>
                    <p><code>-selrpos</code> specifies the positions used in the analysis.</p>
                    <p><code>-b</code> specifies the start time for the analysis.</p>
                    <p><code>-tu</code> specifies the time unit.</p>
                    <p><code>-norm</code> specifies if the density should be normalised to 1.
                        Here we select to keep the number density which will represent the number of atoms in the
                        hydration shell.</p>
                    <p><code>-rmax</code> specifies the maximum distance between two atoms in the analysis.</p>
                    <p>Then, first select <code>OW</code> by typing the group number and hitting <code>Enter</code> and
                        then
                        add <code>Na</code> to the selection. Hit <code>Enter</code> again and exit with
                        <code>Ctrl+D</code></p>
                </blockquote>
            </li>
            <li>
                Use xmgrace to visualise the result.
            </li>
        </ol>
        <div class="flex-figure" style="margin-top:-8mm;">
            <div class="figure" style="width: 70%">
                <figure>
                    <img src="img/rdf.png" width="100%">
                    <figcaption>
                        Example Xmgrace plot of the RDF evolution for water O<sup>2-</sup> to Na<sup>+</sup> during a production run.
                    </figcaption>
                </figure>
            </div>
        </div>
    </div>
    <div class="box">
        <h2 class="enum" id="toc_12">Visualising the results</h2>
        <p>
            You can use the same procedure as in the setup procedure to visualise the trajectory.
        </p>
        <div class="bbox">
            <h3 id="Visualise_trajectory_in_VMD"></h3>
            <ol>
                <li>Visualise the trajectory in <abbr>VMD</abbr></li>
                <li>Open <abbr>VMD</abbr> and load the <code>prod.gro</code> file.</li>
                <li>Load the trajectory file into the molecule.
                    <blockquote>
                        <p>
                            Right-click on the molecule and select <code>Load Data into Molecule</code>.
                            Then, select the <code>prod.xtc</code> trajectory file.
                        </p>
                        <p class="note">The loading of all the frames might take some time. You can speed up the
                            proceed if
                            you hide the molecule during this process. To do this, click on the <code>D</code> next to
                            the molecule
                            entry in the main menu. It will turn red and the molecule will be hidden. Once the
                            trajectory is
                            loaded, you can click on the <code>D</code> again to show the molecule.
                            Use the <code>Play</code> button to play the trajectory. You can adjust the playback with
                            the
                            controls at the bottom of the main window.
                        </p>
                    </blockquote>
                </li>
            </ol>
        </div>
    </div>
</div>

<div class="box">
    <h2>This brings us to the end of the session. Please return to the main menu and provide feedback if you have not done so already.</h2>
    <p> &uarr; <a href="Session3.html">Go to the main menu</a> <br>
        &larr; <a href="part2.html">Go to the previous part &ndash; Running a Molecular Dynamics Simulation</a> </p>
</div>

<script src="../scripts/generate_header.js"></script>
<script src="../scripts/generate_overview.js"></script>
<script src="../scripts/scroll_up.js"></script>
<script src="../scripts/feedback.js"></script>
<script src="../scripts/adjust_for_dyslexia.js"></script>
<script>window.onload = function () {
    generateOverview();
    generateHeader();
    scrollUp();
    adjustForDyslexia()
}</script>
</body>
</html>
